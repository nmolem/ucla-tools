!----------------------------------------------------------------------------------------------
%      subroutine bilinear(x,y,xc,yc,w)
%      !
%      !   p1 = (1-p)(1-q)
%      !   p2 = p(1-q)
%      !   p3 = pq
%      !   p4 = (1-p)*q
%      !   x(p,q) = x1*(1-p)*(1-q) + x2*p*(1-q) + x3*p*q + x4*(1-p)*q
%      !   y(p,q) = y1*(1-p)*(1-q) + y2*p*(1-q) + y3*p*q + y4*(1-p)*q
%      !
%      !     p*q*a1  + p*a2 + q*a3 = a4  ->  p = (a4-q*a3)/(q*a1_a2)
%      !     p*q*a1  + p*b2 + q*b3 = b4
%      !                       q*(a4-q*a3q*a1 - a2))/(
%           x0 = x(jp  ,ip  )
%           x1 = x(jp  ,ip+1)
%           x3 = x(jp+1,ip  )
%           x4 = x(jp+1,ip+1)
%           y0 = y(jp  ,ip  )
%           y1 = y(jp  ,ip+1)
%           y3 = y(jp+1,ip  )
%           y4 = y(jp+1,ip+1)
  
         x(1) = 0;
         x(2) = 0.95;
         x(3) = 0.1;
         x(4) = 0.9;

         y(1) = 0;
         y(2) = 0.1;
         y(3) = 0.9;
         y(4) = 1;

	 xc = 0.5;
	 yc = 0.5;


         x(1) = -73.7047147971707
         x(2) = -73.7110571594359 
         x(3) = -73.6898051454057     
         x(4) = -73.6961455901866     

         y(1) =  33.7156514122322
         y(2) =  33.7280524116894
         y(3) =  33.7209252563245     
         y(4) =  33.7333270718795     

         xc =   -73.7038251266821
         yc =    33.7189279109722     
	 

 
         A = (x(1)-xc)*(y(1)-y(3)) - (y(1)-yc)*(x(1)-x(3))
         B = 0.5*( (x(1)-xc)*(y(2)-y(4)) - (y(1)-yc)*(x(2)-x(4))+(x(2)-xc)*(y(1)-y(3)) - (y(2)-yc)*(x(1)-x(3)) )
         C = (x(2)-xc)*(y(2)-y(4)) - (y(2)-yc)*(x(2)-x(4))


         s = (A-B + sqrt(B*B-A*C) )/(A-2*B + C);
	 if s>1|s<0
           s = (A-B - sqrt(B*B-A*C) )/(A-2*B + C);
         end

	 s


         t1 = ( (1-s)*(x(1)-xc) + s*(x(2)-xc) ) / ( (1-s)*(x(1)-x(3)) + s*(x(2)-x(4)) )
         t2 = ( (1-s)*(y(1)-yc) + s*(y(2)-yc) ) / ( (1-s)*(y(1)-y(3)) + s*(y(2)-y(4)) )

         t = t1

         w(1) = (1-s)*(1-t);
         w(2) =    s*(1-t);
         w(3) = (1-s)*t;
         w(4) =    s*t;

	 cx = sum(w.*x)
	 cy = sum(w.*y)

